Ext.define("Hc_Common.ux.ComboCustom",{extend:"Ext.form.field.ComboBox",alias:"widget.extcombox",queryMode:"local",displayField:null,displaymember:null,valueField:null,valuemember:null,store:null,displayvalue:null,emptyText:"请选择",forceSelection:true,initComponent:function(){var f=[];var h=null;if(this.store==null){if(this.valuemember==null){this.valueField="num";this.displayField="name";var e=this.displayvalue.split(":");for(var d=0;d<e.length;d++){var a=e[d].split("=");var g={};var c=a[0];var b=a[1];g.num=c;g.name=b;f.push(g)}h=Ext.create("Ext.data.Store",{fields:[this.valueField,this.displayField],data:f})}else{this.valueField=this.valuemember;this.displayField=this.displaymember;h=Ext.create("Hc_Common.store.Base",{fields:[this.valueField,this.displayField],proxy:{url:this.displayvalue}})}h.reload();this.store=h}else{this.valueField=this.valuemember;this.displayField=this.displaymember}this.callParent()}});
Ext.define("Hc_Common.ux.ComboUseFlag",{extend:"Ext.form.field.ComboBox",alias:"widget.combouseflag",store:[["",""],[1,"启用"],[0,"禁用"]],editable:false,initComponent:function(){this.callParent()}});
Ext.define("Hc_Common.ux.ComboYesNo",{extend:"Ext.form.field.ComboBox",alias:"widget.comboyesno",store:[["",""],[1,"是"],[0,"否"]],editable:false,initComponent:function(){this.callParent()}});
Ext.define("Hc_Common.ux.DateTimeField",{extend:"Ext.form.field.Date",alias:"widget.bldatetime",readOnly:false,contype:"date",initComponent:function(){this.format=this.format;this.afterMethod("afterRender",function(){this.getEl().applyStyles("top:0")});this.callParent()},createPicker:function(){var a=this,b=Ext.String.format;if(this.contype=="datetime"){if(this.format=="Y-m-d"||this.format==null){this.format="Y-m-d H:i:s"}return new Hc_Common.ux.DateTimePicker({pickerField:a,ownerCt:a.ownerCt,floating:true,focusable:true,hidden:true,minDate:a.minValue,maxDate:a.maxValue,disabledDatesRE:a.disabledDatesRE,disabledDatesText:a.disabledDatesText,disabledDays:a.disabledDays,disabledDaysText:a.disabledDaysText,format:a.format,showToday:a.showToday,startDay:a.startDay,minText:b(a.minText,a.formatDate(a.minValue)),maxText:b(a.maxText,a.formatDate(a.maxValue)),listeners:{scope:a,select:a.onSelect},keyNavConfig:{esc:function(){a.collapse()}}})}else{if(this.contype=="date"){if(this.format==null){this.format="Y-m-d"}return new Ext.picker.Date({pickerField:a,ownerCt:a.ownerCt,floating:true,focusable:true,hidden:true,minDate:a.minValue,maxDate:a.maxValue,disabledDatesRE:a.disabledDatesRE,disabledDatesText:a.disabledDatesText,disabledDays:a.disabledDays,disabledDaysText:a.disabledDaysText,format:a.format,showToday:a.showToday,startDay:a.startDay,minText:b(a.minText,a.formatDate(a.minValue)),maxText:b(a.maxText,a.formatDate(a.maxValue)),listeners:{scope:a,select:a.onSelect},keyNavConfig:{esc:function(){a.collapse()}}})}}}});Ext.define("Hc_Common.ux.DateTimePicker",{extend:"Ext.picker.Date",alias:"widget.datetimepicker",todayText:"确认",timeLabel:"时间",anchor:"100%",onRender:function(b,a){var d=this;if(!this.h){this.h=Ext.create("Ext.form.field.Number",{fieldLabel:this.timeLabel,labelWidth:40,value:this.value.getHours(),minValue:0,maxValue:23,style:"float:left",width:90,baseCls:"inputh",selectOnFocus:true});this.m=Ext.create("Ext.form.field.Number",{value:this.value.getMinutes(),minValue:0,maxValue:59,style:"float:left",inputType:"text",width:40,baseCls:"inputm",selectOnFocus:true});this.s=Ext.create("Ext.form.field.Number",{value:this.value.getSeconds(),minValue:0,maxValue:59,style:"float:left",inputType:"text",width:40,baseCls:"inputs",selectOnFocus:true})}this.h.ownerCt=this;this.m.ownerCt=this;this.s.ownerCt=this;this.h.on("change",this.htimeChange,this);this.m.on("change",this.mtimeChange,this);this.s.on("change",this.stimeChange,this);d.callParent(arguments);d.todayBtn.tooltip="";var c=Ext.get(Ext.DomQuery.selectNode("table",this.el.dom));var e=Ext.core.DomHelper.insertAfter(c.last(),{tag:"tr",style:"border:0px;",children:[{tag:"td",colspan:"7",cls:"x-datepicker-footer ux-timefield"}]},true);this.h.render(this.el.child("div tr td.ux-timefield"));this.m.render(this.el.child("div tr td.ux-timefield"));this.s.render(this.el.child("div tr td.ux-timefield"));this.ht=Ext.get(Ext.DomQuery.selectNode("div.inputh input",this.el.dom));this.ht.on("click",this.htclick,this);this.mt=Ext.get(Ext.DomQuery.selectNode("div.inputm input",this.el.dom));this.mt.on("click",this.mtclick,this);this.st=Ext.get(Ext.DomQuery.selectNode("div.inputs input",this.el.dom));this.st.on("click",this.stclick,this)},htclick:function(){this.ht.focus()},mtclick:function(){this.mt.focus()},stclick:function(){this.st.focus()},handleDateClick:function(d,a){var c=this,b=c.handler;d.stopEvent();if(!c.disabled&&a.dateValue&&!Ext.fly(a.parentNode).hasCls(c.disabledCellCls)){c.setValue(this.fillDateTime(new Date(a.dateValue)));if(b){b.call(c.scope||c,c,c.value)}c.onSelect()}},setValue:function(a){this.value=a;this.changeTimeFiledValue(a);return this.update(Ext.Date.clearTime(this.value||new Date(),true))},changeTimeFiledValue:function(a){this.h.un("change",this.htimeChange,this);this.m.un("change",this.mtimeChange,this);this.s.un("change",this.stimeChange,this);this.h.setValue(a.getHours());this.m.setValue(a.getMinutes());this.s.setValue(a.getSeconds());this.h.on("change",this.htimeChange,this);this.m.on("change",this.mtimeChange,this);this.s.on("change",this.stimeChange,this)},htimeChange:function(c,b,a){this.value=this.fillDateTime(this.value)},mtimeChange:function(c,b,a){this.value=this.fillDateTime(this.value)},stimeChange:function(c,b,a){this.value=this.fillDateTime(this.value)},fillDateTime:function(d){if(this.h){var c=this.h.value;var a=this.m.value;var b=this.s.value;d.setHours(c);d.setMinutes(a);d.setSeconds(b)}return d},getValue:function(){return this.fillDateTime(this.value)},selectToday:function(){var c=this,a=c.todayBtn,b=c.handler;if(a&&!a.disabled){c.setValue(this.fillDateTime(new Date(c.activeDate)));c.fireEvent("select",c,c.value);if(b){b.call(c.scope||c,c,c.value)}c.onSelect()}return c}});
Ext.define("Hc_Common.ux.DropdownList",{extend:"Ext.form.field.ComboBox",alias:"widget.ddlfield",queryMode:"local",displayField:"textField",valueField:"idField",localData:null,url:"",fromFields:"",async:true,getFilters:function(){var e=this,g=[];if(!e.fromFields){return g}var a=e.fromFields.split(","),c=e.up().context,f,d=e.up("form");if(c||d){var b=c&&c.record||d.getRecord();Ext.each(a,function(i){if(b){f=b.get(i)}if(!f&&!d){var h=Hc.getField(d,i);if(h){f=h.getValue()}}g.push({property:i,value:f||"",operator:10})})}return g},afterLoad:function(){},reload:function(){var b=this;b.store.removeAll();if(b.localData){b.store.loadData(b.localData);b.afterLoad()}else{if(b.url){var c=b.getFilters(),a={url:b.url,method:"POST",async:b.async,success:function(g){try{g=JSON.parse(g.responseText);if(g.list){b.store.loadData(g.list)}else{b.store.loadData(g)}b.afterLoad()}catch(f){Hc.alert("无法加载【"+b.fieldLabel+"】,服务端返回无效数据")}},failure:function(){Hc.alert("无法加载【"+b.fieldLabel+"】,请求服务器出错")}};if(!Ext.isEmpty(c)){a.params={queryCondition:JSON.stringify(c)}}Hc.callServer(a)}}},initComponent:function(){var a=this;if(!a.store){a.store=Ext.create("Ext.data.JsonStore",{fields:[a.displayField,a.valueField]});a.reload()}a.callParent(arguments)}});
var Hc=Hc||{};Hc.getField=function(a,b){return a.getForm().getFields().findBy(function(c){return c.name==b})};Hc.alert=function(d,b,a){var c="系统提示";Ext.Msg.alert(c,d,b,a)};Hc.confirm=function(d,b,a){var c="系统提示";Ext.Msg.confirm(c,d,b,a)};Hc.show=function(a){Ext.Msg.show(a)};Hc.clone=function(c){var a;if(Ext.isArray(c)){a=[]}else{if(Ext.isObject(c)){a={}}else{return c}}for(var b in c){var d=c[b];if((Ext.isObject(d)&&d.constructor.name=="Object")||Ext.isArray(d)){a[b]=arguments.callee(d)}else{a[b]=c[b]}}return a};Hc.openUrl=function(b,d,a,c){d=d||"弹出窗口";a=a||1024;c=c||500;if(b.indexOf("?")>0){b+="&_dc="}else{b+="?_dc="}b+=new Date().getTime();Ext.widget("window",{closeAction:"destroy",modal:true,width:a,height:c,title:d,html:'<iframe frameborder=0 width="100%" height="100%" src="'+b+'"></iframe>',autoShow:true})};Hc.callServer=function(a){Ext.Ajax.request(a)};function fillzeno(a){return a<10?"0"+a:a}Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getFullYear()+"-"+fillzeno(this.getMonth()+1)+"-"+fillzeno(this.getDate())+" "+fillzeno(this.getHours())+":"+fillzeno(this.getMinutes())+":"+fillzeno(this.getSeconds()):null};Ext.onReady(function(){Ext.apply(Ext.form.VTypes,{compareTo:function(e,d){this.compareToText=d.compareError||"两次输入的值不一致";var c=d.up("form");var a=d.compareType||"=";if(d.compareTo&&c){var b=c.getValues()[d.compareTo];if(a==">"){return(e>b)}else{if(a==">="){return(e>=b)}else{if(a=="<"){return(e<b)}else{if(a=="<="){return(e<=b)}else{return(e==b)}}}}}return true}})});
Ext.grid.plugin.CellEditing.override({onSpecialKey:function(a,c,b){var d;if(b.getKey()===b.TAB){b.stopEvent();if(a){a.onEditorTab(b)}d=a.getRefOwner().getSelectionModel();return d.onEditorTab(a.editingPlugin,b)}else{if(b.getKey()===b.ENTER){b.stopEvent();if(!(a.editingPlugin.grid.mSizeIdx>-1&&c.column.dataIndex=="materialNo")){if(a){a.onEditorTab(b)}d=a.getRefOwner().getSelectionModel();return d.onEditorTab(a.editingPlugin,b)}else{this.completeEdit()}}}}});Ext.view.View.override({handleEvent:function(d){var c=this,b=c.keyEventRe.test(d.type),a=c.getNavigationModel();d.view=c;if(b){d.item=a.getItem();d.record=a.getRecord()}if(!d.item){d.item=d.getTarget(c.itemSelector)}if(d.item&&!d.record){d.record=c.getRecord(d.item)}if(c.processUIEvent(d)!==false){c.processSpecialEvent(d)}}});Ext.Editor.override({completeOnEnter:false});Ext.grid.header.Container.override({privates:{onHeaderActivate:function(b){var a=this.getFocusableFromEvent(b);if(a&&a.HcfilterEl){if(a.sortable&&this.sortOnClick){a.toggleSortState()}this.onHeaderClick(a,b,a.el)}}}});
Ext.grid.column.Column.override({onTitleElClick:function(f,c){var d=this,a,b,g;if(Ext.supports.Touch){b=d.previousSibling(":not([hidden])");if(!d.menuDisabled&&d.isOnRightEdge(f,parseInt(d.triggerEl.getStyle("width")))){if(!d.menuDisabled){a=d}}else{if(b&&!b.menuDisabled&&d.isOnLeftEdge(f)){a=b}}}else{a=d.triggerEl&&(f.target===d.triggerEl.dom||c===d.triggerEl.dom||f.within(d.triggerEl))?d:null;g=d.HcfilterEl&&(f.target===d.HcfilterEl.dom||c===d.HcfilterEl.dom||f.within(d.HcfilterEl))?d:null}if(!g&&!a&&!d.isOnLeftEdge(f)&&!d.isOnRightEdge(f)||f.getKey()){d.toggleSortState()}return a}});Array.prototype.HcCopy=function(){var c=[];if(this.length<=0){return c}for(var b=0;b<this.length;b++){var a=new Object();a[b]=this[b];c.push(a[b])}return c};
Ext.define("Hc_Common.ux.HcExport",{extend:"Ext.window.Window",alias:"widget.Hcexport",constructor:function(a){var b=this;Ext.apply(b,a);b.callParent(arguments)},initComponent:function(){var a=this;a.fileType=a.fileType||"xls";a.fieldType=a.fieldType||"all";if(a.exportType=="page"){a.title="导出当前页"}else{a.title="导出全部"}a.items=[a._createForm()];a.bbar=["->",{glyph:Hc.Icon.btnSave,text:"确定",itemId:a.id+"_exportOk",handler:a._exportOk},{glyph:Hc.Icon.btnCancel,text:"退出",itemId:a.id+"_exportCanel",handler:a._exportCanel}];a.callParent(arguments)},title:"数据导出",modal:true,resizable:false,ATTRS:{btns:{},fields:{}},initEvents:function(){var a=this;a.ATTRS.btns.btnAllField.on("click",function(){a.fieldType="all";a._allfield()});a.ATTRS.btns.btnCustomField.on("click",function(){a.fieldType="custom";a._customField()});a.ATTRS.btns.btnSelectAll.on("click",function(){a._selectAll()});a.ATTRS.btns.btnUnSelectAll.on("click",function(){a._unSelectAll()});Ext.each(a.ATTRS.btns.btnFileTypes.items.items,function(b){b.on("click",function(){a._selectFileType(this.value)})})},_createForm:function(){var c=this,b,d=c.gridColumns||[],a=[];Ext.each(d,function(e){var f={text:e.text,value:e.dataIndex,handler:c._addOrDelFields,isSelect:false};a.push(f)});b=new Ext.form.Panel({border:false,defaults:{style:"margin:5px 10px 5px 5px;",},items:[{xtype:"fieldcontainer",fieldLabel:"导出文件",labelWidth:70,layout:"hbox",defaults:{xtype:"button",style:"margin:5px 10px 5px 0px;",cls:"Hc-export",},itemId:c.id+"_fileTypes",items:[{text:"Excel(.xls)",itemId:c.id+"_xls",iconCls:c.fileType=="xls"?"Hc-export-select":"",value:"xls"},{text:"Excel(.xlsx)",itemId:c.id+"_xlsx",iconCls:c.fileType=="xlsx"?"Hc-export-select":"",value:"xlsx"}]},{xtype:"fieldcontainer",fieldLabel:"文件名称",layout:"vbox",labelWidth:70,defaults:{style:"margin:5px 10px 5px 0px;"},items:[{xtype:"textfield",emptyText:"请输入导出文件名称",value:c.fileName||"导出文件",allowBlank:false,itemId:c.id+"_exportFileName"}]},{xtype:"fieldcontainer",fieldLabel:"导出字段",layout:"vbox",labelWidth:70,items:[{border:false,layout:"hbox",defaults:{xtype:"button",style:"margin:5px 10px 5px 0px;",cls:"Hc-export"},items:[{text:"所有",itemId:c.id+"_allfield",iconCls:c.fieldType=="all"?"Hc-export-select":"",},{iconCls:c.fieldType!="all"?"Hc-export-select":"",text:"自定义",itemId:c.id+"_Customfield"}]},{border:false,hidden:true,itemId:c.id+"_btnExport",layout:"hbox",defaults:{style:"margin:5px 10px 5px 0px;",xtype:"button",cls:"Hc-export"},items:[{text:"全选",itemId:c.id+"_selectAll",},{text:"反选",itemId:c.id+"_unselectAll"}]},{border:false,layout:"column",labelWidth:70,width:600,hidden:true,itemId:c.id+"_exportFiels",defaults:{style:"margin:5px 5px 5px 0px;",xtype:"button",cls:"Hc-export",columnWidth:0.25,},items:a}]}]});c.ATTRS.fields.exportFiels=b.down("[itemId="+c.id+"_exportFiels]");c.ATTRS.fields.exportFileName=b.down("[itemId="+c.id+"_exportFileName]");c.ATTRS.fields.btnExport=b.down("[itemId="+c.id+"_btnExport]");c.ATTRS.btns.btnFileTypes=b.down("[itemId="+c.id+"_fileTypes]");c.ATTRS.btns.btnSelectAll=b.down("[itemId="+c.id+"_selectAll]");c.ATTRS.btns.btnUnSelectAll=b.down("[itemId="+c.id+"_unselectAll]");c.ATTRS.btns.btnAllField=b.down("[itemId="+c.id+"_allfield]");c.ATTRS.btns.btnCustomField=b.down("[itemId="+c.id+"_Customfield]");return b},_selectAll:function(){var a=this,b=a.ATTRS.fields.exportFiels.items.items;a.ATTRS.btns.btnSelectAll.setIconCls("Hc-export-select");a.ATTRS.btns.btnUnSelectAll.setIconCls("");Ext.each(b,function(c){c.isSelect=true;c.setIconCls("Hc-export-select")})},_unSelectAll:function(){var a=this,b=a.ATTRS.fields.exportFiels.items.items;a.ATTRS.btns.btnSelectAll.setIconCls("");a.ATTRS.btns.btnUnSelectAll.setIconCls("Hc-export-select");Ext.each(b,function(c){c.isSelect=!c.isSelect;if(c.isSelect){c.setIconCls("Hc-export-select")}else{c.setIconCls("")}})},_selectFileType:function(a){var b=this;files=b.ATTRS.btns.btnFileTypes.items.items;Ext.each(files,function(c){c.setIconCls(c.value==a?"Hc-export-select":"")});b.fileType=a},_addOrDelFields:function(){var a=this;a.isSelect=!a.isSelect;if(a.isSelect){a.setIconCls("Hc-export-select")}else{a.setIconCls("")}},_allfield:function(){var e=this,f=e.getWidth(),c=e.getHeight(),d,b,a=e.getXY();e.ATTRS.btns.btnAllField.setIconCls("Hc-export-select");e.ATTRS.btns.btnCustomField.setIconCls("");e.ATTRS.fields.exportFiels.setVisible(false);e.ATTRS.fields.btnExport.setVisible(false);d=e.getWidth();b=e.getHeight();a[0]-=(d-f)*0.5;a[1]-=(b-c)*0.5;e.setXY(a)},_customField:function(){var e=this,f=e.getWidth(),c=e.getHeight(),d,b,a=e.getXY();e.ATTRS.btns.btnAllField.setIconCls("");e.ATTRS.btns.btnCustomField.setIconCls("Hc-export-select");e.ATTRS.fields.exportFiels.setVisible(true);e.ATTRS.fields.btnExport.setVisible(true);d=e.getWidth();b=e.getHeight();a[0]-=(d-f)*0.5;a[1]-=(b-c)*0.5;e.setXY(a)},_exportOk:function(){var b=this,c=b.up("window"),a=c.down("form");if(!a.isValid()){return}c._export()},_export:function(){var i=this,f="",a=i.grid,g=i.objs,o=a.exportUrl,b=g.commonsearch,j="",d=i.ATTRS.fields.exportFileName.getValue(),n=i.fileType,h=[],c=b.getValues("d");if(i.fieldType==="all"){Ext.each(i.gridColumns,function(p){h.push({field:p.dataIndex,title:p.text})})}else{var k=i.ATTRS.fields.exportFiels.items.items;Ext.each(k,function(p){if(p.isSelect===true){h.push({field:p.value,title:p.text})}})}if(!o){Hc.alert("此网格没有提供导出功能");return}if(h.length<=0){f+="请选择导出的列"}if(f!=""){Ext.Msg.alert("导出提示",f);return}if(a.supGrid){var l=i.lookupReference(a.supGrid),m=l.primaryKey,e=l.getSelection()[0].data[m];j=m+"="+e}i.mask("数据导出中...");if(i.exportType=="all"){window.location.href=o+"?exportColumns="+Ext.encode(h)+"&fileName="+d+"&fileType="+n+"&"+c+"&"+j}else{window.location.href=o+"?exportColumns="+Ext.encode(h)+"&fileName="+d+"&fileType="+n+"&pageNum="+a.store.currentPage+"&pageSize="+a.store.pageSize+"&"+c+"&"+j}i.unmask();return false},_exportCanel:function(){var a=this;Hc.confirm("是否关闭？",function(b){if(b!="yes"){return}a.up("window").close()})}});
Ext.define("Hc_Common.ux.HcFilter",{extend:"Ext.form.field.Text",alias:"widget.Hcfilter",requires:["Ext.menu.Menu"],emptyText:"请输入查找内容...",_filterCls:"Hc-common-filter",filterType:"like",initComponent:function(){var a=this;a.callParent(arguments);a.createMenu();a.setFilterType(a.filterType);a.getTrigger("Hcfilter").hide();if(a.menu){a.menu.on("mouseover",function(){a._menuMouseMove()});a.menu.on("mouseleave",function(){a._menuMouseLeave()})}},initEvents:function(){var a=this;a.callParent(arguments);a.on("change",a._change);a.on("blur",a._blur);a.on("focus",a._focus);a.el.on("keyup",a._keyup)},triggers:{Hcfilter:{cls:"Hc-common-triggers-filter",handler:function(b,c,e){var d=this,a=d.el.dom.offsetWidth-61;d.menu.showBy(d,"tl-bl?",[a,0])}}},createMenu:function(){var a=this;if(!a.menu){a.menu=new Ext.menu.Menu({scope:a,maxWidth:100,minWidth:50,items:[{icon:"./resources/static/js/extjs/packages/ext-theme-classic/images/grid/filters/find.png",text:"like",value:"like",operator:"15",pressed:true,handler:function(b){a.setFilterType(this.text);a.fireEvent("onSelectFilter",a.getValue(),a.filterType,b.operator,a)}},{icon:"./resources/static/js/extjs/packages/ext-theme-classic/images/grid/filters/equals.png",text:"=",value:"equal",operator:"10",handler:function(b){a.setFilterType(this.text);a.fireEvent("onSelectFilter",a.getValue(),a.filterType,b.operator,a)}},{icon:"./resources/static/js/extjs/packages/ext-theme-classic/images/grid/filters/greater_than.png",text:">",value:"more",operator:"11",handler:function(b){a.setFilterType(this.text);a.fireEvent("onSelectFilter",a.getValue(),a.filterType,b.operator,a)}},{icon:"./resources/static/js/extjs/packages/ext-theme-classic/images/grid/filters/less_than.png",text:"<",value:"less",operator:"12",handler:function(b){a.setFilterType(this.text);a.fireEvent("onSelectFilter",a.getValue(),a.filterType,b.operator,a)}}]})}return a.menu},getFilterType:function(){return this.filterType},setFilterType:function(d){var c=this,a=c.menu.items.items,b;Ext.each(a,function(f,e){if(d===e){b=f;return false}if(f.value===d||f.operator===d||f.text===d){b=f;return false}});if(!b){return}c._setFilterCls(c._oddCls||b.value,b.value);c.filterType=d;c.operator=b.operator},_menuMouseLeave:function(){var a=this;a.isSelect=false},_menuMouseMove:function(){var a=this;a.isSelect=true;a.getTrigger("Hcfilter").show()},_keyup:function(b){var a=this,c=a.component;c.fireEvent("onHcFilterKeyup",c.getValue(),c.filterType,c.operator,c,b)},_change:function(b,a){b.fireEvent("onHcFilterChange",b.getValue(),b.filterType,b.operator,b,a)},_focus:function(b,a){b.getTrigger("Hcfilter").show()},_blur:function(c,b){var a=this;if(!c.getValue()){c.getTrigger("Hcfilter").hide()}if(a.menu&&!a.isSelect){a.menu.hide()}},_setFilterCls:function(a,c){var b=this;if(!a){a=c}b._oddCls=c;b.addCls(b._filterCls+"-"+c);if(a!=c){b.removeCls(b._filterCls+"-"+a)}}});
Ext.define("Hc_Common.ux.HcHeaderFilter",{extend:"Ext.plugin.Abstract",requires:["Ext.grid.column.Column","Ext.form.Text","Ext.menu.Menu","Hc_Common.ux.HcFilter"],childEls:["titleEl","triggerEl","textEl","HcfilterEl"],headerTpl:['<div id="{id}-titleEl" data-ref="titleEl" {tipMarkup}class="',Ext.baseCSSPrefix,"column-header-inner",'<tpl if="empty"> ',Ext.baseCSSPrefix,'column-header-inner-empty</tpl>">','<span id="{id}-textEl" data-ref="textEl" class="',Ext.baseCSSPrefix,"column-header-text",'{childElCls}">',"{text}","</span>",'<tpl if="!menuDisabled">','<div id="{id}-triggerEl" data-ref="triggerEl" role="presentation" class="',Ext.baseCSSPrefix,"column-header-trigger",'{childElCls}" style="{triggerStyle}"></div>',"</tpl>","</div>",'<div id="{id}-HcfilterEl" data-ref="HcfilterEl" class="Hcfilter-common-body"></div>',"{%this.renderContainer(out,values)%}"],alias:"plugin.Hcheaderfilter",constructor:function(a){var b=this;b.callParent(arguments)},init:function(b){var c=this,a=b.columns;c.grid=b;Ext.each(a,function(e){e.renderTpl=c.headerTpl;var d=e.getChildEls();d.HcfilterEl={itemId:"HcfilterEl",name:"HcfilterEl"};e.setChildEls(d);e.on("afterrender",function(f){c.createHeaderEl(this)})});c.initGridMethods(b);c.initStoreEvents(b);c.callParent(arguments)},initStoreEvents:function(b){var c=this;var a=b.getStore();a.on("load",function(){a.oddData=a.getData().items.HcCopy()});a.on("beforeload",function(){})},createHeaderEl:function(c){var e=this,d=e.grid,a;if(!c.dataIndex){return}var f=c.HcfilterEl;if(f&&!c.HcfilterObj){var b={width:"100%",renderTo:f.dom,property:c.dataIndex};if(!c.HcFilter){c.HcFilter={xtype:"Hcfilter"}}else{if(!c.HcFilter.xtype){c.HcFilter.xtype="Hcfilter"}}if(!c.HcFilter.filterType){c.HcFilter.filterType="like"}switch(c.HcFilter.filterType){case"like":a="15";break;case"=":a="10";break;case">":a="11";break;case"<":a="12";break;default:a="10";break}c.HcFilter.operator=a;c.HcFilter.hidden=c.HcFilter.isOpen==false?true:false;Ext.applyIf(b,c.HcFilter);c.HcfilterObj=Ext.widget(b);if(c.HcFilter.xtype==="Hcfilter"){c.HcfilterObj.on("onSelectFilter",function(k,i,g,h){var j=true;this.operator=g;e._changeValueFilter(d.getFilterLocal(),j)});c.HcfilterObj.on("onHcFilterKeyup",function(m,i,g,h,k){var j=d.getFilterLocal(),l=k.keyCode;e._keyFilter(j,l)});c.HcfilterObj.on("onHcFilterChange",function(m,i,g,h,k){var j=d.getFilterLocal(),l=false;e._changeValueFilter(j,l)})}else{c.HcfilterObj.el.on("keyup",function(j,h){var j=this.component,g=d.getFilterLocal(),i=h.keyCode;e._keyFilter(g,i)});c.HcfilterObj.on("change",function(j,h){var g=d.getFilterLocal(),i=j.inputEl.dom.readOnly;e._changeValueFilter(g,i)})}}},_keyFilter:function(b,c){var a=this;if(!b){if(c!=13){return}a._filterServer()}else{a._filterLocal()}},_changeValueFilter:function(b,c){var a=this;if(!b){if(c){a._filterServer()}}else{a._filterLocal()}},initExtraParams:function(){var d=this,b=d.grid,a=b.getStore(),e=a.getProxy().extraParams,c=d._getFilters()||[];if(b.otherfilter){c=c.concat(b.otherfilter)}if(b.getFilterStatus()==true&&!b.getFilterLocal()){e.queryCondition=Ext.encode(c)}else{if(b.otherfilter){e.queryCondition=Ext.encode(b.otherfilter)}else{delete e.queryCondition}}},_getFilters:function(){var d=this,b=d.grid,a=b.columns,c=[];Ext.each(a,function(f){var g=f.HcfilterObj,e={},h;if(g&&!g.isReadOnly&&!g.hidden){h=g.getValue();if(!Ext.isEmpty(h)){e={value:g.getValue(),operator:g.operator,property:g.property};c.push(e)}}});return c},_filterLocal:function(){var d=this,b=d.grid,a=b.getStore(),c=d._getFilters();if(!a.oddData){return}var e=[];e=a.oddData.filter(function(g){var f=true;Ext.each(c,function(h){var i=g.data[h.property];if(Ext.isEmpty(i)){i=""}if(Ext.isEmpty(h.value)){h.value=""}switch(h.operator){case"15":if(typeof(i)!="string"){f=i.toString().toLowerCase().indexOf(h.value.toLowerCase())>=0}else{f=i.toLowerCase().indexOf(h.value.toLowerCase())>=0}break;case"10":f=i==h.value;break;case"12":var j=typeof(i);switch(j){case"number":f=i<parseInt(h.value);break;case"string":f=d._comparisonDateValue(i,h.value);break;default:f=false;break}break;case"11":var j=typeof(i);switch(j){case"number":f=i>parseInt(h.value);break;case"string":f=!d._comparisonDateValue(i,h.value);break;default:f=false;break}break}if(!f){return false}});return f});d.initExtraParams();a.loadData(e)},_comparisonDateValue:function(b,a){var d=Ext.Date.parse(b,"Y-m-d H:i:s")||Ext.Date.parse(b,"Y-m-d");var c=Ext.Date.parse(a,"Y-m-d H:i:s")||Ext.Date.parse(a,"Y-m-d");if(d&&c){return d.getTime()<c.getTime()}else{return false}},_filterServer:function(){var c=this,b=c.grid,a=b.getStore();c.initExtraParams();a.loadPage(1)},initGridMethods:function(a){var b=this;a.getFilterStatus=function(){return a.isFilter};a.setFilterStatus=function(c){var d=a.getStore();if(c){a.isFilter=true;a.removeCls("grid-filter-hide")}else{a.isFilter=false;a.addCls("grid-filter-hide")}a.fireEvent("onFilterStatusChange",a.isLocal,a.isFilter,a);b.initExtraParams()};a.getFilterLocal=function(){return a.isLocal};a.setFilterLocal=function(c){a.isLocal=c;b.initExtraParams();a.fireEvent("onFilterLocalChange",b.isLocal,b.isFilter,b);if(c){Ext.each(a.columns,function(d){d.HcfilterObj.show()})}else{Ext.each(a.columns,function(d){if(d.HcfilterObj.isOpen==false){d.HcfilterObj.hide()}})}};a.setOtherFilters=function(c){a.otherfilter=c;b.initExtraParams()}}});
Ext.define("Hc_Common.ux.HcImport",{extend:"Ext.window.Window",alias:"widget.Hcimport",constructor:function(a){var b=this;Ext.apply(b,a);b.callParent(arguments)},initComponent:function(){var a=this;a.items=[a._createHeader(),a._createForm()];a.bbar=["->",{glyph:Hc.Icon.btnSave,text:"确定",itemId:a.id+"_ok",handler:a._ok},{glyph:Hc.Icon.btnCancel,text:"退出",itemId:a.id+"_canel",handler:a._canel}];a.callParent(arguments)},layout:"vbox",title:"数据导入",modal:true,resizable:false,_gridHeight:300,ATTRS:{btns:{},fields:{},grids:{}},initEvents:function(){var a=this;a.ATTRS.grids.leftGrid.on("celldblclick",function(b,c,i,d,h,j,f,g){if(d.get("isReadOnly")){return}var k=a.ATTRS.grids.rightGrid.getStore();k.add(d.data);b.getStore().remove(d)});a.ATTRS.grids.rightGrid.on("celldblclick",function(b,c,i,d,h,j,f,g){var k=a.ATTRS.grids.leftGrid.getStore();k.add(d.data);b.getStore().remove(d)});a.ATTRS.btns.btnAdd.on("click",function(){a._add()});a.ATTRS.btns.btnRemove.on("click",function(){a._remove()});a.ATTRS.btns.btnUp.on("click",function(){a._up()});a.ATTRS.btns.btnDown.on("click",function(){a._down()})},_fields:["dataIndex","header","isReadOnly","allowBlank","mainKey"],_createHeader:function(){var a=this;var b="明导入说明导入说明导入说明导入说明";var c=Ext.create("Ext.Component",{itemId:a.id+"_header",html:"<div class='Hc-import-des'>"+b+"</div>"});return c},_createLeftGrid:function(){var d=this,c=d.workObject.columns||[],b,a,e=[];Ext.each(c,function(i){var k=i.text,f=true,j=i.hidden,h=i.editor;if(h){j=false;if(h.allowBlank==false){f=false}else{f=true}}else{j=true}var g={header:k,dataIndex:i.dataIndex,isReadOnly:j,allowBlank:f,mainKey:true};if(!i.hidden){e.push(g)}});a=new Ext.data.Store({fields:d._fields,data:e});b=new Ext.create("Ext.grid.Panel",{columnWidth:0.3,height:d._gridHeight,selModel:Ext.create("Ext.selection.RowModel",{mode:"SIMPLE"}),columns:[{header:"数据列",dataIndex:"isReadOnly",width:"100%",editor:{},renderer:function(l,j,f,m,h,g,i){var k=f.get("header");if(f.get("isReadOnly")){k+="<span style='color:red;'>[只读]</span>"}return k}}],store:a});a.loadData(e);d.ATTRS.grids.leftGrid=b;return b},_createRightGrid:function(){var c=this,b,a;a=new Ext.data.Store({fields:c._fields});b=new Ext.create("Ext.grid.Panel",{columnWidth:0.5,height:c._gridHeight,selModel:Ext.create("Ext.selection.RowModel",{mode:"SIMPLE"}),viewConfig:{plugins:{ptype:"gridviewdragdrop",dragText:"拖动行排序"}},columns:[{header:"Excel列",dataIndex:"header",width:"49.5%",renderer:function(e,d){return e}},{header:"字段类型",dataIndex:"allowBlank",width:"25%",editor:{allowBlank:false},xtype:"bllookupedit",estore:new Ext.data.Store({fields:["text","value"],data:[{text:"必填",value:false},{text:"非必填",value:true}]}),gstore:a,displaymember:"text",valuemember:"value",renderer:function(e,d){d.style="color:blue;";if(!e){return"必填"}else{return"非必填"}}},{header:"验证方式",dataIndex:"mainKey",width:"25%",xtype:"bllookupedit",estore:new Ext.data.Store({fields:["text","value"],data:[{text:"不允许重复",value:true},{text:"允许重复",value:false}],}),gstore:a,displaymember:"text",valuemember:"value",renderer:function(e,d){d.style="color:blue;";if(e){return"不允许重复"}else{return"允许重复"}}}],plugins:{ptype:"cellediting",clicksToEdit:1},store:a});c.ATTRS.grids.rightGrid=b;return b},_createForm:function(){var b=this,a;a=new Ext.form.Panel({border:false,width:600,defaults:{style:"margin:5px 0px 5px 5px;",},items:[{border:false,layout:"column",items:[b._createLeftGrid(),{border:true,height:b._gridHeight,columnWidth:0.2,layout:{align:"middle",pack:"center",type:"vbox"},defaults:{xtype:"button",width:80,height:30,cls:"Hc-export"},items:[{text:"添加",iconCls:"Hc-btn-icon-right",style:"margin-bottom:20px;",itemId:b.id+"_add"},{text:"删除",iconCls:"Hc-btn-icon-left",style:"margin-bottom:20px;",itemId:b.id+"_remove"},{text:"上",iconCls:"Hc-btn-icon-up",style:"margin-bottom:20px;margin-top:20px;",itemId:b.id+"_up"},{text:"下",iconCls:"Hc-btn-icon-down",itemId:b.id+"_down"}]},b._createRightGrid()]},{layout:"column",xtype:"fieldset",title:"高级设置",collapsible:true,defaults:{labelWidth:180,columnWidth:1},items:[{itemId:b.id+"_isValidData",fieldLabel:"是否全部验证通过才导入",layout:"hbox",style:"margin-top:5px;",xtype:"radiogroup",defaults:{style:"margin-left:10px;"},items:[{checked:true,inputValue:true,name:"validStatus",boxLabel:"是(Y)",itemId:b.id+"checkboxY"},{inputValue:false,name:"validStatus",boxLabel:"否(N)",itemId:b.id+"checkboxN"}]},{hidden:true,fieldLabel:"公共验证条件(Json字符串数组)",xtype:"textareafield",itemId:b.id+"validText",style:"margin-bottom:5px;margin-top:10px;"}]}]});b.ATTRS.btns.btnAdd=a.down("[itemId="+b.id+"_add]");b.ATTRS.btns.btnRemove=a.down("[itemId="+b.id+"_remove]");b.ATTRS.btns.btnUp=a.down("[itemId="+b.id+"_up]");b.ATTRS.btns.btnDown=a.down("[itemId="+b.id+"_down]");b.ATTRS.fields.isValidData=a.down("[itemId="+b.id+"_isValidData]");return a},_add:function(){var c=this,b=c.ATTRS.grids.leftGrid,a=b.getStore(),d=b.getSelection();if(!d||d.length<=0){Hc.alert("请选择左边数据列");return}Ext.each(d,function(e){if(!e.data.isReadOnly){c.ATTRS.grids.rightGrid.getStore().add(e.data);a.remove(e)}})},_remove:function(){var c=this,b=c.ATTRS.grids.rightGrid,a=b.getStore(),d=b.getSelection();if(!d||d.length<=0){Hc.alert("请选择右边Excel列");return}Ext.each(d,function(e){c.ATTRS.grids.leftGrid.getStore().add(e.data);a.remove(e)})},_up:function(){var a=this},_down:function(){var a=this},_ok:function(){var b=this,c=b.up("window"),a=c.down("form");if(!a.isValid()){return}c._export()},_canel:function(){var a=this;Hc.confirm("是否关闭？",function(b){if(b!="yes"){return}a.up("window").close()})}});
Ext.define("Hc_Common.ux.SearchHelpField",{extend:"Ext.form.field.Text",xtype:"searchhelpfield",enableKeyEvents:true,url:"",gridColumns:null,searchItems:null,searchColumn:4,fieldWidth:"100%",winTitle:"选择器",winHeight:500,winWidth:700,isAutoLoad:true,otherFields:"",fromFields:"",fieldMap:"",listeners:{keydown:"onKeyDown",keypress:"onKeyPress",blur:"onBlur",afterrender:"onrendered",change:"onChange",scope:"this"},triggers:{search:{cls:"x-form-search-trigger",weight:1,handler:"showSelectWin",scope:"this"}},needCall:false,checkValue:true,initComponent:function(){var a=this;a.needCall=false;a.enableKeyEvents=true;a.callParent(arguments);a.oldValue=a.getValue();if(!a.gridColumns){a.getTrigger("search").hide()}},onrendered:function(){var a=this;if(a.inputEl){a.inputEl.on("dblclick",function(){a.showSelectWin()},a)}},onChange:function(){var a=this;if(Ext.isEmpty(a.getValue())){a.needCall=false;a.oldValue="";if(a.up("grid")){return}a.setOtherFieldsVal()}},showSelectWin:function(){var g=this;if(!g.gridColumns||!g.url||g.readOnly||g.disabled){return}var d=[];Ext.each(g.gridColumns,function(l){d.push(l.dataIndex);Ext.each(g.searchItems,function(m){if(l.dataIndex==m.name){if(!l.HcFilter){l.HcFilter={}}l.HcFilter.isOpen=false}})});var j=Ext.create("Hc_Common.store.Base",{fields:d,autoLoad:false,proxy:{url:g.url}});var b=g.getFromFieldsVal();var f=[{xtype:"grid",border:false,region:"center",columns:g.gridColumns,plugins:["Hcheaderfilter"],columnLines:true,selMode:{mode:"SIMPLE"},store:j,bbar:{xtype:"pagingtoolbar",plugins:Ext.create("Ext.ux.ComboPageSize"),store:j},listeners:{itemdblclick:function(m,l){g.needCall=false;g.setOtherFieldsVal(l.data);m.up("window").close()}}}];var h=function(){var m=e.down("form"),l=[].concat(b);if(!m.isValid()){return}var o=m.getValues();for(var n in o){if(!Ext.isEmpty(o[n])){l.push({property:n,value:o[n],operator:15})}}if(e.down("grid").setOtherFilters){e.down("grid").setOtherFilters(l)}j.reload()};if(g.searchItems){var k=[].concat(g.searchItems);f.push({border:false,xtype:"form",region:"north",bodyPadding:3,items:[{border:false,defaultType:"textfield",layout:{type:"table",columns:g.searchColumn},defaults:{labelAlign:"right",labelWidth:80,width:g.fieldWidth},itemId:"searchfields",items:k}],dockedItems:[{xtype:"toolbar",dock:"top",items:["->",{xtype:"button",text:"查询",width:60,margin:"0 0 0 5",glyph:Hc.Icon.btnSearch,handler:h},{xtype:"button",text:"确认",glyph:Hc.Icon.btnSave,handler:"onReturnValue",scope:g},{xtype:"button",text:"取消",glyph:Hc.Icon.btnCancel,handler:function(l){l.up("window").close()}},{text:"过滤",icon:"./resources/static/js/extjs/packages/ext-theme-classic/images/grid/filters/find.png",itemId:g.id+"btnFilter",reference:"btnFilter",xtype:"splitbutton",menu:[{text:"本页",itemId:g.id+"btnFilterLocal",reference:"btnFilterLocal",handler:function(l){g.onSetFilterLocal(l)}},{text:"所有",itemId:g.id+"btnServer",reference:"btnFilterServer",handler:function(l){g.onSetFilterServer(l)}},{text:"关闭",itemId:g.id+"btnFilterClose",reference:"btnFilterClose",handler:function(l){g.onFilterClose(l)}}]}]}]})}var e=Ext.widget("window",{title:g.winTitle,width:g.winWidth,height:g.winHeight,modal:true,constrain:true,layout:"border",closeAction:"destroy",autoShow:true,items:f});var i=e.down("form"),c=i&&i.query("textfield,combo,datefield,numberfield");if(c){Ext.each(c,function(l){l.on("specialkey",function(n,m){if(m.ctrlKey&&m.getKey()===m.ENTER){h(n)}});l.labelEl.on("dblclick",function(n,m){if(l.readOnly||l.canInput==false||l.isDisabled()==true){return}l.setValue("")})})}e.searchField=g;var a=e.down("grid");if(!Ext.isEmpty(b)){if(a.setOtherFilters){a.setOtherFilters(b)}}if(g.isAutoLoad){j.load()}if(a.setFilterStatus){a.setFilterStatus(false)}g._setBtnFilterText(e.down("form").down("[itemId="+g.id+"btnFilter]"))},getSearchItems:function(){},onFilterClose:function(b){var c=this,d=b.up("window"),a=d.down("grid");if(typeof(a.setFilterStatus)=="function"){a.setFilterStatus(false);c._setBtnFilterText(b.up("[itemId='"+c.id+"btnFilter']"))}},onSetFilterLocal:function(b){var c=this,d=b.up("window"),a=d.down("grid");a.isLocal=true;if(typeof(a.setFilterStatus)=="function"){a.setFilterStatus(true)}c._setBtnFilterText(b.up("[itemId='"+c.id+"btnFilter']"))},onSetFilterServer:function(b){var c=this,d=b.up("window"),a=d.down("grid");a.isLocal=false;if(typeof(a.setFilterStatus)=="function"){a.setFilterStatus(true)}c._setBtnFilterText(b.up("[itemId='"+c.id+"btnFilter']"))},_setBtnFilterText:function(b){var c=this,d=b.up("window"),a=d.down("grid");if(typeof(a.setFilterStatus)!="function"){b.setText("请加入filter插件");return}if(a.getFilterStatus()){text="过滤["+(a.isLocal?"本页":"所有")+"]"}else{text="过滤"}b.setText(text)},onReturnValue:function(c){var d=this,e=c.up("window"),b=e.down("grid"),a=b.getSelection();if(a.length<1){Hc.alert("必须选择一条记录");return}d.needCall=false;d.setOtherFieldsVal(a[0].data);e.close()},onBlur:function(){this.sendToServer()},onKeyDown:function(b){var a=this;if(b.getKey()===b.ENTER||b.getKey()===b.TAB){a.sendToServer()}else{if(b.getKey()===b.F4){a.showSelectWin()}else{if(b.getKey()===b.BACKSPACE||(b.ctrlKey&&b.getKey()==b.V)){a.needCall=true}}}},onKeyPress:function(a){this.needCall=true},getFieldMap:function(){var c=[],a=this;if(!a.fieldMap){return c}var b=a.fieldMap.split(",");Ext.each(b,function(e){var d=e.split("=");if(d.length==2){var f={s:d[0],t:d[1]};c.push(f)}});return c},getFromFieldsVal:function(){var d=this,g=[];if(!d.fromFields){return g}var a=d.fromFields.split(","),b=d.up().context,f,c=d.up("form"),e=d.getFieldMap();if(b||c){Ext.each(a,function(i){f="";if(b){f=b.record.get(i)}if(!f&&c){var h=Hc.getField(c,i);if(h){f=h.getValue()}}var j=Ext.Array.findBy(e,function(k){return k.s==i});g.push({property:(j&&j.t)||i,value:f||"",operator:10})})}return g},sendToServer:function(){var b=this;if(!b.needCall||!b.checkValue){return}b.needCall=false;if(!b.url||Ext.isEmpty(b.getValue())){b.setOtherFieldsVal();return}var e=b.getFromFieldsVal(),d=b.getValue(),c=Ext.Array.findBy(b.getFieldMap(),function(g){return g.s==b.name}),f=c&&c.t||b.name;e.push({property:f,value:d,operator:10});var a={url:b.url,params:{queryCondition:JSON.stringify(e)},method:"POST",success:function(i){try{var g=JSON.parse(i.responseText);if(!g.list||g.list.length==0){Hc.alert("输入【"+d+"】是无效的值",function(){b.setOtherFieldsVal()})}else{b.setOtherFieldsVal(g.list[0])}}catch(h){Hc.alert("输入值【"+d+"】后端验证失败",function(){b.setOtherFieldsVal()})}},failure:function(){Hc.alert("数据精灵验证失败，请联系管理员",function(){b.setOtherFieldsVal()})}};Hc.callServer(a)},setOtherFieldsVal:function(e){var k=this,c=k.up("form"),a=k.up("grid"),d=k.up().context,i,h=k.getFieldMap();e=e||{};if(d){i=d.record}else{if(c){i=c.getRecord()}}if(a&&d){a.editingPlugin.startEdit(i,d.column)}if(k.afterCall(k,e,i,d)===false){return}var b=Ext.Array.findBy(h,function(l){return l.s==k.name}),g=b&&b.t||k.name,f=e[g];if(f==null){f=k.oldValue}k.setValue(f);if(d){i.set(k.name,f)}k.oldValue=k.getValue();if(!k.otherFields){return}var j=k.otherFields.split(",");Ext.each(j,function(m){b=Ext.Array.findBy(h,function(n){return n.s==m});g=b&&b.t||m;if(d){i.set(m,e[g]||"")}else{var l=Hc.getField(c,m);if(l){l.setValue(e[g]||"")}if(i){i.set(m,e[g]||"")}}})},afterCall:function(b,d,a,c){}});
Ext.define("Hc_Common.ux.extGridComoboxColumn",{extend:"Ext.grid.column.Column",alias:"widget.bllookupedit",estore:null,gstore:null,readOnly:false,editable:true,initComponent:function(){var h=this;h.type="0";if(h.readOnly){if(h.gstore==null){var a=null;if(h.valuemember==null){h.valuemember="num";h.displaymember="name";var g=g||[];var m=h.displayvalue.split(":");for(var d=0;d<m.length;d++){var l=m[d].split("=");var c={};var k=l[0];var j=l[1];c.num=k;c.name=j;g.push(c)}a=Ext.create("Ext.data.Store",{fields:[h.valuemember,h.displaymember],data:g});h.type="1"}else{a=Ext.create("Hc_Common.store.Base",{fields:[h.valuemember,h.displaymember],proxy:{url:h.displayvalue}})}a.reload();h.store=a}else{h.store=h.gstore}}else{var b=h.editor&&h.editor.allowBlank;h.editor=Ext.create("Hc_Common.ux.ComboCustom",{displaymember:h.displaymember,valuemember:h.valuemember,displayvalue:h.displayvalue,store:h.estore,editable:this.editable});if(b===false){h.editor.allowBlank=false}if(h.valuemember==null){h.valuemember="num";h.displaymember="name";h.type="1"}if(h.gstore==null){h.store=h.editor.store}else{h.store=h.gstore}}try{h.callParent()}catch(f){Hc.alert(f)}},defaultRenderer:function(c){var b=this,a=a||{};if(c==null){return}if(b.type=="0"){a=b.store.findExact(b.valuemember,c)}else{a=b.store.findExact(b.valuemember,c.toString())}return a>-1?b.store.getAt(a).data[b.displaymember]:c}});
Ext.define("Hc_Common.ux.extGridDateColumn",{extend:"Ext.grid.column.Date",alias:"widget.blgriddate",format:"Y-m-d",readOnly:false,editable:false,initComponent:function(){if(!this.readOnly){var a=this.editor&&this.editor.allowBlank;this.editor=Ext.create("Hc_Common.ux.DateTimeField",{format:this.format,readOnly:this.readOnly,value:this.value,contype:"date",editable:this.editable});if(a===false){this.editor.allowBlank=false}}this.callParent()}});
Ext.define("Hc_Common.ux.extGridDateTimeColumn",{extend:"Ext.grid.column.Date",alias:"widget.blgriddatetime",format:"Y-m-d H:i:s",readOnly:false,initComponent:function(){if(!this.readOnly){var a=this.editor&&this.editor.allowBlank;this.editor=Ext.create("Hc_Common.ux.DateTimeField",{format:this.format,readOnly:this.readOnly,value:this.value,contype:"datetime"});if(a===false){this.editor.allowBlank=false}}this.callParent()}});
Ext.define("Hc_Common.ux.gridComboUseFlag",{extend:"Hc_Common.ux.extGridComoboxColumn",alias:"widget.gridcombouseflag",displayvalue:"1=启用:0=禁用",editable:false,initComponent:function(){this.callParent()}});
Ext.define("Hc_Common.ux.gridComboYesNo",{extend:"Hc_Common.ux.extGridComoboxColumn",alias:"widget.gridcomboyesno",displayvalue:"1=是:0=否",editable:false,initComponent:function(){this.callParent()}});
